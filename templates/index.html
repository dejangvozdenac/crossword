{% extends "layout.html" %}

{% block main %}
  <center><h1>Crossword Puzzle</h1></center>

  {% if check is not none %}
    {% if check %}
      <script>alert("Correct!");</script>
    {% else %}
      <script>alert("Incorrect");</script>
    {% endif %}
  {% endif %}

  <div id="wrap">
    <div class="col">
      <!-- clues -->
      <h2>Across</h2>
      {% for clue in cluesAcross %}
        <div>{{ clue.number ~ ". " ~ clue.clue }}</div>
      {% endfor %}
    </div>

    <div class="colgut">
      <!-- the crossword image -->
      <div id="wrapper">
        {% for row in state.array %}
          {% for cell in row %}
            {% if cell.variety == "BLACK" %}
              <div class="filled"></div>
            {% elif cell.numbered %}
              {% if cell.variety == "WHITE_INCORRECT" %}
                <div class="empty numbered incorrect">
                  {% if cell.letter %}
                    <div class="letter">{{ cell.letter }}</div>
                  {% endif %}
                </div>
              {% else %}
                <div class="empty numbered">
                  {% if cell.letter %}
                    <div class="letter">{{ cell.letter }}</div>
                  {% endif %}
                </div>
              {% endif %}
            {% else %}
              {% if cell.variety == "WHITE_INCORRECT" %}
                <div class="empty incorrect">
                  {% if cell.letter %}
                    <div class="letter">{{ cell.letter }}</div>
                  {% endif %}
                </div>
              {% else %}
                <div class="empty">
                  {% if cell.letter %}
                    <div class="letter">{{ cell.letter }}</div>
                  {% endif %}
                </div>
              {% endif %}
            {% endif %}
          {% endfor %}
        {% endfor %}
      </div>

      <!-- form submission -->
      <form action="{{ url_for('command') }}" id="command" method="post">
        <div class="form-group">
          <b><label>Clue:</label></b>
          <input class="form-control" name="clue" id="clueText" placeholder="4 a"/>
        </div>

        <div class="form-group">
          <b><label>Letter position (optional):</label></b>
          <input class="form-control" name="position" placeholder="3"/>
        </div>

        <div class="form-group">
          <b><label>Solution:</label></b>
          <input class="form-control" name="solution" id="solutionText" placeholder="aria"/>
        </div>

        <div class="form-group">
          <input type="submit" name="command_type" value="Fill"></button>
          <input type="submit" name="command_type" value="Delete"></button>
          <input type="submit" name="command_type" value="Check"></button>
          <input type="submit" name="command_type" value="New Puzzle"></button>
        </div>
      </form>
    </div>

    <div class="col">
      <h2>Down</h2>
      {% for clue in cluesDown %}
        <div>{{ clue.number ~ ". " ~ clue.clue }}</div>
      {% endfor %}
    </div>
  </div>

  <script>
    $(document).click(function(event) {
      var clueObj = event.target;
      var text = $(clueObj).text();
      var clueNumber = text.split(".")[0];
      var direction = clueObj.parentNode.getElementsByTagName("h2")[0].innerHTML;

      $("#clueText").val(clueNumber + " " + direction[0]);
      $("#clueText").css("color", "red");
      $("#solutionText").focus();
    });
  </script>
{% endblock %}